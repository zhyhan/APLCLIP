./logs
Environment:
	Python: 3.11.3
	PyTorch: 2.0.0+cu117
	Torchvision: 0.15.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.3
	PIL: 9.5.0
Args:
	algorithm: APLCLIP
	checkpoint_freq: None
	data_dir: /home/zhongyi.han/dataset
	dataset: VLCS
	holdout_fraction: 0.1
	hparams: {"clip_backbone": "ViT-B/16"}
	hparams_seed: 0
	output_dir: ./logs
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [2]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	backbone: clip
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	clip_backbone: ViT-B/16
	clip_transform: True
	d_steps_per_g_step: 1
	data_augmentation: True
	grad_penalty: 0.0
	lambda: 1.0
	lr: 0.001
	lr_d: 0.001
	lr_g: 0.0001
	mlp_depth: 3
	mlp_dropout: 0.2
	mlp_width: 512
	momentum: 0.1
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	test_envs: [2]
	weight_decay: 0.0
	weight_decay_d: 0.0
	weight_decay_g: 0.0
Using clip_transform ViT-B/16
Set self.clip_model.parameters.reguires_grad = False!
Set self.clip_model.parameters.reguires_grad = False!
Initial context: "cause the presence of"
Number of context words (tokens): 4
ViT-B/16
Using ViT-B/16...
class_loss    disc_loss     env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  epoch         lr            step          step_time    
5.8162798882  1.0955913067  0.9976452119  0.9929078014  0.7068172313  0.7245283019  0.7034529452  0.6829268293  0.8259295821  0.8605341246  0.0000000000  0.0001000000  0             2.6502795219 
4.5422726870  0.2931786155  0.9992150706  1.0000000000  0.8260142200  0.8339622642  0.7914691943  0.7774390244  0.9108259296  0.9347181009  7.5353218210  0.0000999238  300           1.2101155059 
4.2613086430  0.5147638169  0.9992150706  1.0000000000  0.8477624425  0.8339622642  0.8097494922  0.7713414634  0.9312273774  0.9376854599  15.070643642  0.0000994767  600           2.0194386212 
4.1550040674  0.5858951216  0.9992150706  1.0000000000  0.8728565454  0.8377358491  0.8171970210  0.7926829268  0.9486673248  0.9347181009  22.605965463  0.0000985909  900           1.7236616675 
4.0721189292  0.5987993874  0.9984301413  1.0000000000  0.8707653701  0.8075471698  0.8229519296  0.8140243902  0.9549193814  0.9436201780  30.141287284  0.0000972742  1200          2.1781639942 
4.1025284656  0.6133699268  0.9968602826  0.9929078014  0.8958594730  0.8150943396  0.8192281652  0.8079268293  0.9670944390  0.9406528190  37.676609105  0.0000955384  1500          2.1779948751 
4.0054692777  0.6582193088  1.0000000000  1.0000000000  0.9042241740  0.8188679245  0.8111035884  0.8140243902  0.9674234946  0.9376854599  45.211930926  0.0000933988  1800          2.0758447655 
3.9867255847  0.6492893045  0.9976452119  0.9929078014  0.9268088666  0.8377358491  0.8019634394  0.7835365854  0.9792694965  0.9406528190  52.747252747  0.0000908744  2100          2.0704937728 
4.0477373457  0.7016498666  0.9992150706  0.9929078014  0.9468841489  0.8452830189  0.7992552471  0.7926829268  0.9842053307  0.9287833828  60.282574568  0.0000879876  2400          2.0685064300 
3.9537160238  0.7542228130  1.0000000000  1.0000000000  0.9573400251  0.8113207547  0.8083953961  0.8140243902  0.9825600526  0.9198813056  67.817896389  0.0000847642  2700          2.0684453185 
3.9584227101  0.7620979615  0.9992150706  1.0000000000  0.9782517775  0.8377358491  0.7995937712  0.7957317073  0.9921026654  0.9317507418  75.353218210  0.0000812326  3000          2.0930240671 
4.0443112771  0.7814031317  1.0000000000  1.0000000000  0.9828523630  0.8415094340  0.7918077183  0.7896341463  0.9944060546  0.9347181009  82.888540031  0.0000774242  3300          2.1810420672 
4.0807503478  0.7668271867  0.9984301413  1.0000000000  0.9891258887  0.8452830189  0.7843601896  0.7439024390  0.9927607766  0.9258160237  90.423861852  0.0000733728  3600          2.1813390152 
3.9591360458  0.7664682333  0.9992150706  1.0000000000  0.9882894187  0.8301886792  0.7836831415  0.7621951220  0.9973675551  0.9376854599  97.959183673  0.0000691145  3900          2.1823100519 
4.0373768520  0.7556385330  0.9992150706  1.0000000000  0.9903805939  0.8415094340  0.7921462424  0.7774390244  0.9953932215  0.9317507418  105.49450549  0.0000646869  4200          2.1052663692 
4.0048173682  0.7392376169  0.9984301413  1.0000000000  0.9958176495  0.8377358491  0.7735274204  0.7591463415  0.9963803883  0.9376854599  113.02982731  0.0000601294  4500          2.0768004783 
3.8149916744  0.7527579689  0.9984301413  1.0000000000  0.9941447093  0.8150943396  0.7894380501  0.7713414634  0.9976966107  0.9317507418  120.56514913  0.0000554824  4800          2.0604252887 
3.8766143966  0.7686678538  0.9984301413  1.0000000000  0.9937264743  0.8264150943  0.7836831415  0.7743902439  0.9976966107  0.9347181009  125.58869701  0.0000515717  5000          2.0938871992 
